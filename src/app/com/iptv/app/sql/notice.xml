<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="notice">
	<select id="getNoticePaged" resultType="java.util.HashMap">
		SELECT a.* FROM biz_notice a WHERE (a.IsDel IS NULL OR a.IsDel = 0) ORDER BY CreateDate DESC
	</select>

	<select id="getNoticeById" resultType="java.util.HashMap">
		SELECT a.* FROM biz_notice a Where a.Id = #{Id} 
	</select>

	<insert id="saveNotice" parameterType="java.util.HashMap">
		<!-- INSERT INTO biz_notice
			(Title, Content, Introduction,Subhead,CreateDate, UserId, IsDel)
		VALUES
			(#{Title}, #{Content},#{Introduction},#{Subhead},#{CreateDate}, #{UserId}, #{IsDel}) -->
		INSERT INTO biz_notice
			(Title, Content, Introduction,Subhead,CreateDate, UserId, IsDel,CategoryId,StartDate,EndDate,Province,City,Area)
		VALUES
			(#{Title}, #{Content},#{Introduction},#{Subhead},#{CreateDate}, #{UserId}, #{IsDel},#{CategoryId},#{StartDate},#{EndDate},#{Province},#{City},#{Area})
	</insert>

	<update id="updateNotice" parameterType="java.util.HashMap">
		UPDATE biz_notice SET Title = #{Title}, Subhead = #{Subhead},Content = #{Content},Introduction = #{Introduction},
			CategoryId=#{CategoryId},StartDate=#{StartDate},EndDate=#{EndDate},Province=#{Province},City=#{City},Area=#{Area}
		WHERE Id = #{Id}
	</update>

	<update id="deleteNotice" parameterType="java.util.HashMap">
		UPDATE biz_notice SET IsDel = 1
		WHERE Id IN
		<foreach collection="Id" index="index" item="item" open="(" separator="," close=")">  
            #{item}   
		</foreach>
	</update>

	<select id="getNoticeByPage" resultType="java.util.HashMap">
		SELECT a.*
		FROM biz_notice a
		WHERE (a.IsDel IS NULL OR a.IsDel = 0)
		ORDER BY a.CreateDate DESC
		LIMIT ${offset},${rows}
	</select>

	<select  id="getNoticePageNum" resultType="java.lang.Integer" >
		SELECT  ceil(count(1)/8)
		FROM biz_notice a
		WHERE (a.IsDel IS NULL OR a.IsDel = 0)
		ORDER BY a.CreateDate DESC
	</select>
	
	<select id="getLatestNotice" resultType="java.util.HashMap">
		SELECT a.Id,a.Title
		FROM biz_notice a
		WHERE (a.IsDel IS NULL OR a.IsDel = 0)
		ORDER BY a.CreateDate DESC
		LIMIT 0,1
	</select>
</mapper>